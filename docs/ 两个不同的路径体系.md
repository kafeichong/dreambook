 ä¸¤ä¸ªä¸åŒçš„è·¯å¾„ä½“ç³»

  1ï¸âƒ£ æœ¬åœ°ä»£ç è·¯å¾„ï¼ˆä½ çš„ Macï¼‰                                                                          â”€

  æˆ‘ä»¬åˆšæ‰è°ƒæ•´å¥½çš„ç»“æ„ï¼š
  /Users/steven/works/20251130dreambook/code/
  â”œâ”€â”€ dreambook-api/          # åç«¯æºç 
  â”œâ”€â”€ dreambook-web/          # å‰ç«¯æºç 
  â”œâ”€â”€ dreambook-kiosk/        # Electron æºç 
  â”œâ”€â”€ deploy/                 # éƒ¨ç½²é…ç½®
  â””â”€â”€ _archive/               # å½’æ¡£

  ç”¨é€”ï¼š
  - âœ… Git ä»“åº“ç®¡ç†
  - âœ… æœ¬åœ°å¼€å‘
  - âœ… æ„å»ºç¼–è¯‘
  - âœ… ä¸Šä¼ åˆ°æœåŠ¡å™¨

  ---
  2ï¸âƒ£ æœåŠ¡å™¨éƒ¨ç½²è·¯å¾„ï¼ˆUbuntu æœåŠ¡å™¨ï¼‰

  æˆ‘åˆšæ‰è§„åˆ’çš„æ˜¯è¿™ä¸ªï¼š
  /data/                      # æœåŠ¡å™¨æ•°æ®ç›˜
  â”œâ”€â”€ nginx-shared/           # å…±äº« Nginxï¼ˆè¿è¡Œæ—¶ï¼‰
  â”‚   â”œâ”€â”€ conf.d/
  â”‚   â”œâ”€â”€ ssl/
  â”‚   â””â”€â”€ logs/
  â”‚
  â”œâ”€â”€ emotion-library/        # emotion-library é¡¹ç›®ï¼ˆè¿è¡Œæ—¶ï¼‰
  â”‚   â”œâ”€â”€ code/               # ä» Git æ‹‰å–æˆ–ä¸Šä¼ çš„ä»£ç 
  â”‚   â”œâ”€â”€ data/               # æ•°æ®åº“ã€ä¸Šä¼ æ–‡ä»¶ç­‰
  â”‚   â””â”€â”€ dist-web/           # å‰ç«¯æ„å»ºäº§ç‰©
  â”‚
  â””â”€â”€ dreambook/              # dreambook é¡¹ç›®ï¼ˆè¿è¡Œæ—¶ï¼‰
      â”œâ”€â”€ code/               # ä»ä½ æœ¬åœ°ä¸Šä¼ çš„ä»£ç 
      â”œâ”€â”€ data/               # è¿è¡Œæ—¶æ•°æ®
      â””â”€â”€ dist-web/           # å‰ç«¯æ„å»ºäº§ç‰©

  ---
  ğŸ”„ å®Œæ•´çš„æµç¨‹

  ä»æœ¬åœ°åˆ°æœåŠ¡å™¨çš„æ˜ å°„å…³ç³»

  æœ¬åœ° Mac                                  æœåŠ¡å™¨ Ubuntu
  â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  /Users/steven/.../code/dreambook-api/  â†’  /data/dreambook/code/dreambook-api/
  /Users/steven/.../code/dreambook-web/  â†’  /data/dreambook/code/dreambook-web/
  /Users/steven/.../code/deploy/         â†’  /data/dreambook/code/deploy/

  æ„å»ºåï¼š
  dreambook-web/dist/                    â†’  /data/dreambook/dist-web/

  ---
  ğŸ“ è¯¦ç»†è¯´æ˜

  æœ¬åœ°ï¼ˆå¼€å‘ç¯å¢ƒï¼‰

  ç›®å½•ç»“æ„ï¼š
  code/
  â”œâ”€â”€ dreambook-api/              # ä½ åœ¨è¿™é‡Œå¼€å‘åç«¯
  â”‚   â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ package.json
  â”‚   â””â”€â”€ Dockerfile
  â”‚
  â”œâ”€â”€ dreambook-web/              # ä½ åœ¨è¿™é‡Œå¼€å‘å‰ç«¯
  â”‚   â”œâ”€â”€ src/
  â”‚   â”œâ”€â”€ package.json
  â”‚   â””â”€â”€ vite.config.ts
  â”‚
  â””â”€â”€ deploy/                     # éƒ¨ç½²é…ç½®
      â”œâ”€â”€ docker-compose.yml
      â””â”€â”€ nginx-configs/

  ä½ çš„å·¥ä½œï¼š
  # æœ¬åœ°å¼€å‘
  cd dreambook-api && npm run dev
  cd dreambook-web && npm run dev

  # æœ¬åœ°æ„å»º
  cd dreambook-web && npm run build  # ç”Ÿæˆ dist/

  # æäº¤ä»£ç 
  git add . && git commit -m "..." && git push

  ---
  æœåŠ¡å™¨ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰

  ç›®å½•ç»“æ„ï¼š
  /data/
  â”œâ”€â”€ nginx-shared/               # Nginx å®¹å™¨é…ç½®
  â”‚   â”œâ”€â”€ docker-compose.yml     # Nginx çš„å¯åŠ¨é…ç½®
  â”‚   â”œâ”€â”€ conf.d/
  â”‚   â”‚   â”œâ”€â”€ emotion-library.conf
  â”‚   â”‚   â””â”€â”€ dreambook.conf
  â”‚   â”œâ”€â”€ ssl/
  â”‚   â””â”€â”€ logs/
  â”‚
  â”œâ”€â”€ emotion-library/            # emotion-library è¿è¡Œç¯å¢ƒ
  â”‚   â”œâ”€â”€ code/                  # ä¸Šä¼ åˆ°è¿™é‡Œçš„ä»£ç 
  â”‚   â”‚   â”œâ”€â”€ backend/
  â”‚   â”‚   â”œâ”€â”€ frontend/
  â”‚   â”‚   â””â”€â”€ docker-compose.yml
  â”‚   â”œâ”€â”€ data/                  # è¿è¡Œæ—¶æ•°æ®
  â”‚   â”‚   â”œâ”€â”€ postgres/
  â”‚   â”‚   â””â”€â”€ uploads/
  â”‚   â””â”€â”€ dist-web/              # emotion-library å‰ç«¯æ„å»ºäº§ç‰©
  â”‚
  â””â”€â”€ dreambook/                  # dreambook è¿è¡Œç¯å¢ƒ
      â”œâ”€â”€ code/                  # ä¸Šä¼ åˆ°è¿™é‡Œçš„ä»£ç 
      â”‚   â”œâ”€â”€ dreambook-api/
      â”‚   â”œâ”€â”€ dreambook-web/
      â”‚   â””â”€â”€ docker-compose.yml
      â”œâ”€â”€ data/                  # è¿è¡Œæ—¶æ•°æ®
      â”‚   â””â”€â”€ logs/
      â””â”€â”€ dist-web/              # dreambook å‰ç«¯æ„å»ºäº§ç‰©

  æœåŠ¡å™¨çš„å·¥ä½œï¼š
  # æ‹‰å–ä»£ç 
  cd /data/dreambook/code
  git clone <your-repo> .

  # æˆ–è€…ä¸Šä¼ ä»£ç 
  scp -r code/* user@server:/data/dreambook/code/

  # æ„å»ºå‰ç«¯
  cd /data/dreambook/code/dreambook-web
  npm install && npm run build
  cp -r dist/* /data/dreambook/dist-web/

  # å¯åŠ¨å®¹å™¨
  cd /data/dreambook/code
  docker-compose up -d

  ---
  ğŸ¯ æ­£ç¡®çš„ç†è§£

  æˆ‘åˆšæ‰è§„åˆ’çš„æ˜¯ï¼š

  1. âœ… æœåŠ¡å™¨ä¸Šçš„éƒ¨ç½²ç›®å½•ç»“æ„
    - ä»£ç ä¸Šä¼ åˆ°å“ªé‡Œ
    - Docker å®¹å™¨å¦‚ä½•ç»„ç»‡
    - æ•°æ®å­˜å‚¨åœ¨å“ªé‡Œ
  2. âŒ ä¸æ˜¯æœ¬åœ°ä»£ç çš„ç»“æ„
    - ä½ æœ¬åœ°çš„ä»£ç ç»“æ„å·²ç»è°ƒæ•´å¥½äº†
    - ä¸éœ€è¦å†æ”¹

  å…³é”®åŒºåˆ«
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚   æ–¹é¢   â”‚   æœ¬åœ°ï¼ˆä½ çš„ Macï¼‰   â”‚  æœåŠ¡å™¨ï¼ˆUbuntuï¼‰   â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ç›®çš„     â”‚ å¼€å‘ã€æ„å»ºã€ç‰ˆæœ¬æ§åˆ¶ â”‚ è¿è¡Œã€æä¾›æœåŠ¡      â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ä»£ç æ¥æº â”‚ Git ä»“åº“             â”‚ ä»æœ¬åœ°ä¸Šä¼ /Git æ‹‰å– â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ ç›®å½•ç»“æ„ â”‚ æˆ‘ä»¬åˆšè°ƒæ•´å¥½çš„       â”‚ æˆ‘åˆšæ‰è§„åˆ’çš„        â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ è¿è¡Œæ–¹å¼ â”‚ npm run dev          â”‚ Docker å®¹å™¨         â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ æ•°æ®å­˜å‚¨ â”‚ ä¸´æ—¶å¼€å‘æ•°æ®         â”‚ æŒä¹…åŒ–ç”Ÿäº§æ•°æ®      â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  ---
  ğŸ“‹ å®Œæ•´çš„éƒ¨ç½²æµç¨‹å›¾

  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ æœ¬åœ°å¼€å‘ï¼ˆä½ çš„ Macï¼‰                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ /Users/steven/.../code/                     â”‚
  â”‚ â”œâ”€â”€ dreambook-api/    â† ä½ åœ¨è¿™å¼€å‘          â”‚
  â”‚ â”œâ”€â”€ dreambook-web/    â† ä½ åœ¨è¿™å¼€å‘          â”‚
  â”‚ â””â”€â”€ deploy/           â† éƒ¨ç½²é…ç½®            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
           Git Push / SCP ä¸Šä¼ 
                  â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ æœåŠ¡å™¨éƒ¨ç½²ï¼ˆUbuntuï¼‰                          â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ /data/dreambook/code/                       â”‚
  â”‚ â”œâ”€â”€ dreambook-api/    â† ä»£ç åœ¨è¿™            â”‚
  â”‚ â”œâ”€â”€ dreambook-web/    â† ä»£ç åœ¨è¿™            â”‚
  â”‚ â””â”€â”€ docker-compose.yml                      â”‚
  â”‚                                             â”‚
  â”‚ /data/dreambook/dist-web/  â† å‰ç«¯æ„å»ºäº§ç‰©   â”‚
  â”‚ /data/dreambook/data/      â† è¿è¡Œæ—¶æ•°æ®     â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
           Docker å®¹å™¨è¿è¡Œ
                  â†“
  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
  â”‚ Docker å®¹å™¨                                 â”‚
  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
  â”‚ - nginx-shared       (ç«¯å£ 80/443)         â”‚
  â”‚ - dreambook-backend  (ç«¯å£ 3000)           â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

  ---
  ğŸ’¡ æ‰€ä»¥ï¼Œå›ç­”ä½ çš„é—®é¢˜

  æˆ‘åˆšæ‰è§„åˆ’çš„æ˜¯ï¼šæœåŠ¡å™¨ä¸Šçš„ Docker éƒ¨ç½²è·¯å¾„ï¼

  - âœ… æœ¬åœ°ä»£ç è·¯å¾„ï¼šæˆ‘ä»¬å·²ç»è°ƒæ•´å¥½äº†ï¼ˆdreambook-api/, dreambook-web/ ç­‰ï¼‰
  - âœ… æœåŠ¡å™¨éƒ¨ç½²è·¯å¾„ï¼šæˆ‘åˆšæ‰åœ¨è§„åˆ’ï¼ˆ/data/dreambook/, /data/nginx-shared/ ç­‰ï¼‰

  ä¸¤è€…çš„å…³ç³»ï¼š
  # 1. ä½ åœ¨æœ¬åœ°å¼€å‘
  cd /Users/steven/.../code/dreambook-web
  npm run build

  # 2. ä¸Šä¼ åˆ°æœåŠ¡å™¨
  scp -r dist user@server:/data/dreambook/dist-web/

  # 3. æœåŠ¡å™¨ä¸Šè¿è¡Œ
  ssh user@server
  cd /data/dreambook/code
  docker-compose up -d

  ---
  â“ éœ€è¦æˆ‘ç»§ç»­è§„åˆ’ä»€ä¹ˆ

  ç°åœ¨éœ€è¦æˆ‘å¸®ä½ ï¼š

  1. âœ… æœ¬åœ°ä»£ç ç»“æ„ - å·²å®Œæˆ
  2. âœ… æœåŠ¡å™¨ç›®å½•ç»“æ„ - åˆšæ‰è§„åˆ’çš„
  3. â“ è¯¦ç»†çš„éƒ¨ç½²æ­¥éª¤ - ä»æœ¬åœ°åˆ°æœåŠ¡å™¨çš„å®Œæ•´æµç¨‹
  4. â“ å…·ä½“çš„é…ç½®æ–‡ä»¶ - docker-compose.yml, nginx.conf ç­‰

  éœ€è¦æˆ‘ç»§ç»­ç»†åŒ–å“ªéƒ¨åˆ†ï¼Ÿ