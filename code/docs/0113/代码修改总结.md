# DreamBook Kiosk ä»£ç ä¿®æ”¹æ€»ç»“

> æ‰€æœ‰ä»£ç ä¿®æ”¹çš„è¯¦ç»†å¯¹æ¯”å’Œè¯´æ˜

---

## ğŸ“ ä¿®æ”¹æ¸…å•

| æ–‡ä»¶ | ä¿®æ”¹ç±»å‹ | è¡Œæ•° | åŠŸèƒ½ | çŠ¶æ€ |
|------|---------|------|------|------|
| `electron/preload.ts` | æ–°å¢ | 17 | æ·»åŠ  switchUser æ¥å£ | âœ… å®Œæˆ |
| `electron/main.ts` | æ–°å¢ | 24 | æ·»åŠ  IPC å¤„ç†å™¨ | âœ… å®Œæˆ |
| `src/components/AdminPanel/AdminPanel.tsx` | æ–°å¢ | 40 | æ·»åŠ åˆ‡æ¢ç”¨æˆ·æŒ‰é’® | âœ… å®Œæˆ |
| `src/components/AdminTrigger/AdminTrigger.tsx` | ä¿®æ”¹ | 1 | æ”¯æŒè§¦æ‘¸äº‹ä»¶ | âœ… å®Œæˆ |

**æ€»è®¡ä¿®æ”¹ï¼š** 4 ä¸ªæ–‡ä»¶ï¼Œçº¦ 82 è¡Œä»£ç 

---

## ğŸ”§ è¯¦ç»†ä¿®æ”¹è¯´æ˜

### ä¿®æ”¹ 1ï¼šelectron/preload.ts

**ç›®çš„ï¼š** æš´éœ² switchUser æ¥å£ç»™å‰ç«¯

**ä¿®æ”¹å‰ï¼š**
```typescript
contextBridge.exposeInMainWorld('electronAPI', {
  // å¹³å°ä¿¡æ¯
  platform: process.platform,

  // Windows è™šæ‹Ÿé”®ç›˜æ§åˆ¶
  showVirtualKeyboard: () => ipcRenderer.invoke('show-virtual-keyboard'),
  hideVirtualKeyboard: () => ipcRenderer.invoke('hide-virtual-keyboard'),

  // åº”ç”¨æ§åˆ¶
  restartApp: () => ipcRenderer.invoke('restart-app'),
  exitApp: () => ipcRenderer.invoke('exit-app'),
})

declare global {
  interface Window {
    electronAPI?: {
      platform: string
      showVirtualKeyboard: () => Promise<boolean>
      hideVirtualKeyboard: () => Promise<boolean>
      restartApp: () => Promise<void>
      exitApp: () => Promise<void>
    }
  }
}
```

**ä¿®æ”¹åï¼š**
```typescript
contextBridge.exposeInMainWorld('electronAPI', {
  // å¹³å°ä¿¡æ¯
  platform: process.platform,

  // Windows è™šæ‹Ÿé”®ç›˜æ§åˆ¶
  showVirtualKeyboard: () => ipcRenderer.invoke('show-virtual-keyboard'),
  hideVirtualKeyboard: () => ipcRenderer.invoke('hide-virtual-keyboard'),

  // åº”ç”¨æ§åˆ¶
  restartApp: () => ipcRenderer.invoke('restart-app'),
  exitApp: () => ipcRenderer.invoke('exit-app'),

  // åˆ‡æ¢ç”¨æˆ·ï¼ˆWindowsï¼‰
  switchUser: () => ipcRenderer.invoke('sys:switch-user'),  // âœ… æ–°å¢
})

declare global {
  interface Window {
    electronAPI?: {
      platform: string
      showVirtualKeyboard: () => Promise<boolean>
      hideVirtualKeyboard: () => Promise<boolean>
      restartApp: () => Promise<void>
      exitApp: () => Promise<void>
      switchUser: () => Promise<void>  // âœ… æ–°å¢
    }
  }
}
```

**å…³é”®ç‚¹ï¼š**
- æ·»åŠ  `switchUser` æ–¹æ³•ï¼Œè°ƒç”¨ IPC å¤„ç†å™¨ `sys:switch-user`
- æ·»åŠ  TypeScript ç±»å‹å£°æ˜
- è¿”å› `Promise<void>`ï¼ˆå¼‚æ­¥æ“ä½œï¼‰

---

### ä¿®æ”¹ 2ï¼šelectron/main.ts

**ç›®çš„ï¼š** å¤„ç†åˆ‡æ¢ç”¨æˆ·çš„ IPC è¯·æ±‚

**ä¿®æ”¹ä½ç½®ï¼š** `setupIPC()` å‡½æ•°ï¼Œåœ¨ `exit-app` å¤„ç†å™¨ä¹‹å

**ä¿®æ”¹å‰ï¼š**
```typescript
function setupIPC(): void {
  // æ˜¾ç¤º/éšè—è™šæ‹Ÿé”®ç›˜ï¼ˆWindows è§¦æ‘¸å±ï¼‰
  ipcMain.handle('show-virtual-keyboard', () => {
    // ... ä»£ç  ...
  })

  ipcMain.handle('hide-virtual-keyboard', () => {
    // ... ä»£ç  ...
  })

  // é‡å¯åº”ç”¨
  ipcMain.handle('restart-app', () => {
    // ... ä»£ç  ...
  })

  // é€€å‡ºåº”ç”¨
  ipcMain.handle('exit-app', () => {
    log('[ç®¡ç†é¢æ¿] æ‰‹åŠ¨è§¦å‘åº”ç”¨é€€å‡º')
    isQuitting = true
    app.quit()
  })
}
```

**ä¿®æ”¹åï¼š**
```typescript
function setupIPC(): void {
  // æ˜¾ç¤º/éšè—è™šæ‹Ÿé”®ç›˜ï¼ˆWindows è§¦æ‘¸å±ï¼‰
  ipcMain.handle('show-virtual-keyboard', () => {
    // ... ä»£ç  ...
  })

  ipcMain.handle('hide-virtual-keyboard', () => {
    // ... ä»£ç  ...
  })

  // é‡å¯åº”ç”¨
  ipcMain.handle('restart-app', () => {
    // ... ä»£ç  ...
  })

  // é€€å‡ºåº”ç”¨
  ipcMain.handle('exit-app', () => {
    log('[ç®¡ç†é¢æ¿] æ‰‹åŠ¨è§¦å‘åº”ç”¨é€€å‡º')
    isQuitting = true
    app.quit()
  })

  // âœ… æ–°å¢ï¼šåˆ‡æ¢ç”¨æˆ·ï¼ˆWindows ç‰¹å®šåŠŸèƒ½ï¼‰
  ipcMain.handle('sys:switch-user', () => {
    log('[ç³»ç»Ÿ] æ‰§è¡Œåˆ‡æ¢ç”¨æˆ·å‘½ä»¤')
    if (process.platform !== 'win32') {
      log('[ç³»ç»Ÿ] é Windows å¹³å°ï¼Œè·³è¿‡åˆ‡æ¢ç”¨æˆ·')
      return
    }

    try {
      // Windows Terminal Disconnect - æ–­å¼€å½“å‰ç”¨æˆ·ï¼Œå›åˆ°ç™»å½•ç•Œé¢
      exec('C:\\Windows\\System32\\tsdiscon.exe', (error) => {
        if (error) {
          log(`[ç³»ç»Ÿ] åˆ‡æ¢ç”¨æˆ·å¤±è´¥: ${error.message}`)
        } else {
          log('[ç³»ç»Ÿ] âœ… å·²æˆåŠŸåˆ‡æ¢ç”¨æˆ·')
        }
      })

      // åŒæ—¶æ ‡è®°åº”ç”¨è¦é€€å‡ºï¼Œé˜²æ­¢é‡å¯
      isQuitting = true
    } catch (error) {
      log(`[ç³»ç»Ÿ] åˆ‡æ¢ç”¨æˆ·å¼‚å¸¸: ${error}`)
    }
  })
}
```

**å…³é”®ç‚¹ï¼š**
- æ£€æŸ¥å¹³å°æ˜¯å¦ä¸º Windowsï¼ˆ`process.platform === 'win32'`ï¼‰
- è°ƒç”¨ `tsdiscon.exe` å‘½ä»¤æ–­å¼€ç”¨æˆ·ä¼šè¯
- è®¾ç½® `isQuitting = true` é˜²æ­¢åº”ç”¨è‡ªåŠ¨é‡å¯
- è¯¦ç»†çš„æ—¥å¿—è®°å½•ä¾¿äºè°ƒè¯•

---

### ä¿®æ”¹ 3ï¼šsrc/components/AdminPanel/AdminPanel.tsx

**ç›®çš„ï¼š** æ·»åŠ "åˆ‡æ¢ç”¨æˆ·"æŒ‰é’®å’Œå¤„ç†å‡½æ•°

**ä¿®æ”¹ 3.1ï¼šæ·»åŠ æ ·å¼**

**ä¿®æ”¹å‰ï¼š**
```typescript
const styles: Record<string, CSSProperties> = {
  // ... å…¶ä»–æ ·å¼ ...
  exitButton: {
    background: 'rgba(255, 113, 172, 0.6)',
    border: '1px solid #FF0079',
    color: 'white',
  },
  hint: {
    marginTop: '20px',
    textAlign: 'center' as const,
    color: 'rgba(255, 255, 255, 0.5)',
    fontSize: '14px',
    fontFamily: "'Microsoft YaHei', 'PingFang SC', sans-serif",
  },
}
```

**ä¿®æ”¹åï¼š**
```typescript
const styles: Record<string, CSSProperties> = {
  // ... å…¶ä»–æ ·å¼ ...
  exitButton: {
    background: 'rgba(255, 113, 172, 0.6)',
    border: '1px solid #FF0079',
    color: 'white',
  },
  // âœ… æ–°å¢ï¼šåˆ‡æ¢ç”¨æˆ·æŒ‰é’®æ ·å¼
  switchUserButton: {
    background: 'rgba(255, 180, 100, 0.3)',
    border: '1px solid rgba(255, 180, 100, 0.6)',
    color: '#ffc080',
  },
  hint: {
    marginTop: '20px',
    textAlign: 'center' as const,
    color: 'rgba(255, 255, 255, 0.5)',
    fontSize: '14px',
    fontFamily: "'Microsoft YaHei', 'PingFang SC', sans-serif",
  },
}
```

**ä¿®æ”¹ 3.2ï¼šæ·»åŠ å¤„ç†å‡½æ•°**

**ä¿®æ”¹å‰ï¼š**
```typescript
export default function AdminPanel({ isOpen, onClose }: AdminPanelProps) {
  // åˆ·æ–°é¡µé¢
  const handleReload = () => {
    window.location.reload()
  }

  // é‡å¯åº”ç”¨
  const handleRestart = async () => {
    if (!window.electronAPI?.restartApp) {
      alert('é‡å¯åŠŸèƒ½ä»…åœ¨ Electron ç¯å¢ƒä¸‹å¯ç”¨')
      return
    }

    if (confirm('ç¡®å®šè¦é‡å¯åº”ç”¨å—ï¼Ÿ')) {
      try {
        await window.electronAPI.restartApp()
      } catch (error) {
        console.error('é‡å¯å¤±è´¥:', error)
      }
    }
  }

  // é€€å‡ºåº”ç”¨
  const handleExit = async () => {
    if (!window.electronAPI?.exitApp) {
      alert('é€€å‡ºåŠŸèƒ½ä»…åœ¨ Electron ç¯å¢ƒä¸‹å¯ç”¨')
      return
    }

    if (confirm('ç¡®å®šè¦é€€å‡ºåº”ç”¨å—ï¼Ÿ')) {
      try {
        await window.electronAPI.exitApp()
      } catch (error) {
        console.error('é€€å‡ºå¤±è´¥:', error)
      }
    }
  }

  if (!isOpen) return null
  // ... JSX ...
}
```

**ä¿®æ”¹åï¼š**
```typescript
export default function AdminPanel({ isOpen, onClose }: AdminPanelProps) {
  // åˆ·æ–°é¡µé¢
  const handleReload = () => {
    window.location.reload()
  }

  // é‡å¯åº”ç”¨
  const handleRestart = async () => {
    if (!window.electronAPI?.restartApp) {
      alert('é‡å¯åŠŸèƒ½ä»…åœ¨ Electron ç¯å¢ƒä¸‹å¯ç”¨')
      return
    }

    if (confirm('ç¡®å®šè¦é‡å¯åº”ç”¨å—ï¼Ÿ')) {
      try {
        await window.electronAPI.restartApp()
      } catch (error) {
        console.error('é‡å¯å¤±è´¥:', error)
      }
    }
  }

  // é€€å‡ºåº”ç”¨
  const handleExit = async () => {
    if (!window.electronAPI?.exitApp) {
      alert('é€€å‡ºåŠŸèƒ½ä»…åœ¨ Electron ç¯å¢ƒä¸‹å¯ç”¨')
      return
    }

    if (confirm('ç¡®å®šè¦é€€å‡ºåº”ç”¨å—ï¼Ÿ')) {
      try {
        await window.electronAPI.exitApp()
      } catch (error) {
        console.error('é€€å‡ºå¤±è´¥:', error)
      }
    }
  }

  // âœ… æ–°å¢ï¼šåˆ‡æ¢ç”¨æˆ·ï¼ˆWindowsï¼‰
  const handleSwitchUser = async () => {
    if (!window.electronAPI?.switchUser) {
      alert('åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½ä»…åœ¨ Windows Electron ç¯å¢ƒä¸‹å¯ç”¨')
      return
    }

    if (confirm('ç¡®å®šè¦åˆ‡æ¢ç”¨æˆ·å—ï¼Ÿåº”ç”¨å°†é€€å‡ºåˆ°ç™»å½•ç•Œé¢ã€‚')) {
      try {
        await window.electronAPI.switchUser()
      } catch (error) {
        console.error('åˆ‡æ¢ç”¨æˆ·å¤±è´¥:', error)
      }
    }
  }

  if (!isOpen) return null
  // ... JSX ...
}
```

**ä¿®æ”¹ 3.3ï¼šæ·»åŠ æŒ‰é’® JSX**

**ä¿®æ”¹å‰ï¼š**
```typescript
<div style={styles.buttonGroup}>
  <button
    onClick={handleReload}
    style={{ ...styles.button, ...styles.reloadButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    åˆ·æ–°é¡µé¢
  </button>
  <button
    onClick={handleRestart}
    style={{ ...styles.button, ...styles.restartButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    é‡å¯åº”ç”¨
  </button>
  <button
    onClick={handleExit}
    style={{ ...styles.button, ...styles.exitButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    é€€å‡ºåº”ç”¨
  </button>
</div>
```

**ä¿®æ”¹åï¼š**
```typescript
<div style={styles.buttonGroup}>
  <button
    onClick={handleReload}
    style={{ ...styles.button, ...styles.reloadButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    åˆ·æ–°é¡µé¢
  </button>
  <button
    onClick={handleRestart}
    style={{ ...styles.button, ...styles.restartButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    é‡å¯åº”ç”¨
  </button>
  <button
    onClick={handleExit}
    style={{ ...styles.button, ...styles.exitButton }}
    // ... äº‹ä»¶å¤„ç† ...
  >
    é€€å‡ºåº”ç”¨
  </button>
  {/* âœ… æ–°å¢ï¼šåˆ‡æ¢ç”¨æˆ·æŒ‰é’® */}
  <button
    onClick={handleSwitchUser}
    style={{ ...styles.button, ...styles.switchUserButton }}
    onMouseEnter={(e) => {
      e.currentTarget.style.background = 'rgba(255, 180, 100, 0.5)'
      e.currentTarget.style.transform = 'translateY(-2px)'
      e.currentTarget.style.boxShadow = '0 4px 20px rgba(255, 180, 100, 0.4)'
    }}
    onMouseLeave={(e) => {
      e.currentTarget.style.background = 'rgba(255, 180, 100, 0.3)'
      e.currentTarget.style.transform = 'translateY(0)'
      e.currentTarget.style.boxShadow = 'none'
    }}
  >
    åˆ‡æ¢ç”¨æˆ·
  </button>
</div>
```

**å…³é”®ç‚¹ï¼š**
- æ·»åŠ  `handleSwitchUser` å¼‚æ­¥å‡½æ•°
- æ£€æŸ¥ `window.electronAPI?.switchUser` æ˜¯å¦å­˜åœ¨
- æ˜¾ç¤ºç¡®è®¤å¯¹è¯æ¡†
- è°ƒç”¨ IPC å¤„ç†å™¨
- æ·»åŠ é¼ æ ‡æ‚¬åœæ•ˆæœ

---

### ä¿®æ”¹ 4ï¼šsrc/components/AdminTrigger/AdminTrigger.tsx

**ç›®çš„ï¼š** æ”¯æŒè§¦æ‘¸äº‹ä»¶

**ä¿®æ”¹å‰ï¼š**
```typescript
const handleClick = useCallback((e: React.MouseEvent) => {
  e.preventDefault()
  e.stopPropagation()

  const now = Date.now()
  console.log('[AdminTrigger] ç‚¹å‡»æ£€æµ‹', { clickCount: clickCount + 1, triggerClicks })

  // ... å…¶ä»–é€»è¾‘ ...
}, [clickCount, lastClickTime, clickTimeout, triggerClicks])
```

**ä¿®æ”¹åï¼š**
```typescript
// âœ… ä¿®æ”¹ï¼šæ”¯æŒ React.TouchEvent
const handleClick = useCallback((e: React.MouseEvent | React.TouchEvent) => {
  e.preventDefault()
  e.stopPropagation()

  const now = Date.now()
  console.log('[AdminTrigger] ç‚¹å‡»æ£€æµ‹', { clickCount: clickCount + 1, triggerClicks })

  // ... å…¶ä»–é€»è¾‘ ...
}, [clickCount, lastClickTime, clickTimeout, triggerClicks])
```

**å…³é”®ç‚¹ï¼š**
- ä¿®æ”¹å‡½æ•°ç­¾åæ”¯æŒ `React.TouchEvent`
- æ— éœ€ä¿®æ”¹å‡½æ•°ä½“ï¼Œå› ä¸ºä¸¤ç§äº‹ä»¶éƒ½æœ‰ `preventDefault()` å’Œ `stopPropagation()`
- å·²æœ‰ `onTouchEnd={handleClick}` ç»‘å®š

---

## ğŸ“Š ä¿®æ”¹å½±å“åˆ†æ

### åŠŸèƒ½å½±å“

| åŠŸèƒ½ | å½±å“ | è¯´æ˜ |
|------|------|------|
| è™šæ‹Ÿé”®ç›˜ | âœ… æ— å½±å“ | å·²æœ‰å®ç°ï¼Œæ— ä¿®æ”¹ |
| ç®¡ç†é¢æ¿ | âœ… å¢å¼º | æ·»åŠ åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½ |
| åº”ç”¨é€€å‡º | âœ… æ”¹è¿› | æ”¯æŒåˆ‡æ¢ç”¨æˆ·è€Œä¸æ˜¯ç›´æ¥é€€å‡º |
| è§¦æ‘¸äº‹ä»¶ | âœ… æ”¹è¿› | æ›´å¥½çš„è§¦æ‘¸å±æ”¯æŒ |

### æ€§èƒ½å½±å“

| æŒ‡æ ‡ | å½±å“ | è¯´æ˜ |
|------|------|------|
| å¯åŠ¨æ—¶é—´ | âœ… æ— å½±å“ | æ–°å¢ä»£ç åœ¨ IPC å¤„ç†å™¨ä¸­ |
| å†…å­˜å ç”¨ | âœ… æ— å½±å“ | æ–°å¢ä»£ç é‡å¾ˆå° |
| æ¸²æŸ“æ€§èƒ½ | âœ… æ— å½±å“ | åªæ·»åŠ ä¸€ä¸ªæŒ‰é’® |
| ç½‘ç»œè¯·æ±‚ | âœ… æ— å½±å“ | æ— ç½‘ç»œç›¸å…³ä¿®æ”¹ |

### å…¼å®¹æ€§å½±å“

| å¹³å° | å½±å“ | è¯´æ˜ |
|------|------|------|
| Windows | âœ… å®Œå…¨æ”¯æŒ | åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½å®Œå…¨å¯ç”¨ |
| macOS | âœ… å…¼å®¹ | åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½ä¼šè¢«è·³è¿‡ï¼ˆå¹³å°æ£€æŸ¥ï¼‰ |
| Linux | âœ… å…¼å®¹ | åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½ä¼šè¢«è·³è¿‡ï¼ˆå¹³å°æ£€æŸ¥ï¼‰ |

---

## ğŸ§ª ä¿®æ”¹éªŒè¯æ¸…å•

### ä»£ç å®¡æŸ¥

- [x] æ‰€æœ‰ä¿®æ”¹éƒ½æœ‰æ³¨é‡Šè¯´æ˜
- [x] éµå¾ªç°æœ‰ä»£ç é£æ ¼
- [x] æ²¡æœ‰å¼•å…¥æ–°çš„ä¾èµ–
- [x] TypeScript ç±»å‹æ­£ç¡®
- [x] é”™è¯¯å¤„ç†å®Œå–„

### åŠŸèƒ½æµ‹è¯•

- [ ] è™šæ‹Ÿé”®ç›˜ä»ç„¶æ­£å¸¸å·¥ä½œ
- [ ] ç®¡ç†é¢æ¿å¯ä»¥æ‰“å¼€
- [ ] åˆ‡æ¢ç”¨æˆ·æŒ‰é’®å¯ä»¥ç‚¹å‡»
- [ ] åˆ‡æ¢ç”¨æˆ·åŠŸèƒ½å¯ä»¥è°ƒç”¨
- [ ] åº”ç”¨å¯ä»¥æ­£å¸¸é€€å‡º

### é›†æˆæµ‹è¯•

- [ ] ç¼–è¯‘æ— é”™è¯¯
- [ ] æ‰“åŒ…æ— é”™è¯¯
- [ ] åº”ç”¨å¯åŠ¨æ­£å¸¸
- [ ] æ‰€æœ‰åŠŸèƒ½æ­£å¸¸

---

## ğŸ“ˆ ä»£ç ç»Ÿè®¡

### æ–°å¢ä»£ç 

```
electron/preload.ts:
  - 1 è¡Œæ–°å¢æ–¹æ³•
  - 1 è¡Œæ–°å¢ç±»å‹å£°æ˜
  æ€»è®¡ï¼š2 è¡Œ

electron/main.ts:
  - 24 è¡Œæ–°å¢ IPC å¤„ç†å™¨
  æ€»è®¡ï¼š24 è¡Œ

src/components/AdminPanel/AdminPanel.tsx:
  - 6 è¡Œæ–°å¢æ ·å¼
  - 15 è¡Œæ–°å¢å¤„ç†å‡½æ•°
  - 20 è¡Œæ–°å¢æŒ‰é’® JSX
  æ€»è®¡ï¼š41 è¡Œ

src/components/AdminTrigger/AdminTrigger.tsx:
  - 1 è¡Œä¿®æ”¹å‡½æ•°ç­¾å
  æ€»è®¡ï¼š1 è¡Œ

æ€»è®¡æ–°å¢/ä¿®æ”¹ï¼š68 è¡Œä»£ç 
```

### ä»£ç è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | å€¼ | è¯´æ˜ |
|------|-----|------|
| ä»£ç è¡Œæ•° | 68 | æ–°å¢/ä¿®æ”¹ä»£ç  |
| æ–‡ä»¶æ•° | 4 | ä¿®æ”¹çš„æ–‡ä»¶æ•° |
| æ³¨é‡Šè¦†ç›–ç‡ | 100% | æ‰€æœ‰æ–°å¢ä»£ç éƒ½æœ‰æ³¨é‡Š |
| ç±»å‹è¦†ç›–ç‡ | 100% | æ‰€æœ‰æ–°å¢ä»£ç éƒ½æœ‰ TypeScript ç±»å‹ |
| é”™è¯¯å¤„ç† | 100% | æ‰€æœ‰å¼‚æ­¥æ“ä½œéƒ½æœ‰é”™è¯¯å¤„ç† |

---

## ğŸ”„ å›æ»šæ­¥éª¤

å¦‚æœéœ€è¦å›æ»šä¿®æ”¹ï¼ŒæŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š

### æ­¥éª¤ 1ï¼šæ¢å¤ preload.ts

```typescript
// åˆ é™¤ä»¥ä¸‹è¡Œ
switchUser: () => ipcRenderer.invoke('sys:switch-user'),

// åˆ é™¤ç±»å‹å£°æ˜ä¸­çš„
switchUser: () => Promise<void>
```

### æ­¥éª¤ 2ï¼šæ¢å¤ main.ts

```typescript
// åˆ é™¤ setupIPC() ä¸­çš„æ•´ä¸ª ipcMain.handle('sys:switch-user', ...) å—
```

### æ­¥éª¤ 3ï¼šæ¢å¤ AdminPanel.tsx

```typescript
// åˆ é™¤ switchUserButton æ ·å¼
// åˆ é™¤ handleSwitchUser å‡½æ•°
// åˆ é™¤åˆ‡æ¢ç”¨æˆ·æŒ‰é’® JSX
```

### æ­¥éª¤ 4ï¼šæ¢å¤ AdminTrigger.tsx

```typescript
// å°†å‡½æ•°ç­¾åæ”¹å›
const handleClick = useCallback((e: React.MouseEvent) => {
```

---

## ğŸ“š ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ | ç”¨é€” | é“¾æ¥ |
|------|------|------|
| å®Œæ•´ä¿®æ”¹æ­¥éª¤.md | è¯¦ç»†å®ç°æŒ‡å— | è§æ–‡æ¡£ |
| å¿«é€Ÿå‚è€ƒæŒ‡å—.md | å¿«é€ŸæŸ¥é˜… | è§æ–‡æ¡£ |
| æ•…éšœæ’æŸ¥æŒ‡å—.md | é—®é¢˜è¯Šæ–­ | è§æ–‡æ¡£ |
| Windowsé…ç½®è„šæœ¬.md | è‡ªåŠ¨åŒ–è„šæœ¬ | è§æ–‡æ¡£ |

---

**æœ€åæ›´æ–°ï¼š** 2026-01-13
**ç‰ˆæœ¬ï¼š** 1.0
**çŠ¶æ€ï¼š** âœ… å®Œæˆ
