# Windows 构建脚本运行说明

## 🎯 最简单的方法（推荐）

直接在 PowerShell 中运行：

```powershell
cd C:\code\dreambook
npm run electron:build:win
```

## 📋 可用的命令

所有命令都已在 `package.json` 中配置好，直接使用：

```powershell
# 构建 Windows 安装程序
npm run electron:build:win

# 只构建目录（不创建安装程序，用于测试）
npm run electron:build:win:dir

# 跳过类型检查（更快）
npm run electron:build:win:skip-check
```

## 🔧 直接运行 PowerShell 脚本

如果您想直接运行脚本文件：

### 方法 A：正常运行

```powershell
cd C:\code\dreambook
.\scripts\build-win.ps1
```

### 方法 B：如果遇到执行策略错误

错误信息可能类似：
```
无法加载文件 ...\build-win.ps1，因为在此系统上禁止运行脚本
```

**解决方案 1：绕过执行策略运行**

```powershell
powershell -ExecutionPolicy Bypass -File .\scripts\build-win.ps1
```

**解决方案 2：修改执行策略（一次设置）**

1. 以管理员身份运行 PowerShell
2. 执行：
   ```powershell
   Set-ExecutionPolicy RemoteSigned
   ```
3. 输入 `Y` 确认

之后就可以直接运行：
```powershell
.\scripts\build-win.ps1
```

## 📝 脚本参数说明

直接运行脚本时可以使用参数：

```powershell
# 完整构建
.\scripts\build-win.ps1

# 只构建目录
.\scripts\build-win.ps1 -Dir

# 跳过类型检查
.\scripts\build-win.ps1 -SkipCheck

# 组合使用
.\scripts\build-win.ps1 -Dir -SkipCheck
```

## ✅ 推荐做法

**建议使用方法 1（通过 npm）**，因为：
- ✅ 不需要修改执行策略
- ✅ 命令更简短
- ✅ 已在 package.json 中配置好

只需要运行：
```powershell
npm run electron:build:win
```

## 📚 更多信息

- 脚本会自动禁用代码签名并清除缓存
- 构建完成后，文件会输出到 `release/` 目录
- 详细说明请查看 `WINDOWS_BUILD.md`

