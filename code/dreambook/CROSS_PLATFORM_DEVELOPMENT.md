# è·¨å¹³å°å¼€å‘è¯´æ˜

## âŒ macOS å’Œ Windows ä¸èƒ½å…±äº« node_modules

**ç®€çŸ­å›ç­”**ï¼š**ä¸å»ºè®®**åœ¨ macOS å’Œ Windows ä¹‹é—´å…±äº« `node_modules` ç›®å½•ã€‚

## ğŸ” åŸå› åˆ†æ

### 1. åŸç”Ÿæ¨¡å—é—®é¢˜

æŸäº› npm åŒ…åŒ…å«åŸç”ŸäºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆnative addonsï¼‰ï¼Œè¿™äº›æ˜¯ä¸ºç‰¹å®šå¹³å°ç¼–è¯‘çš„ï¼š

- **Electron** - ä¸åŒå¹³å°éœ€è¦ä¸åŒçš„äºŒè¿›åˆ¶æ–‡ä»¶
- **node-gyp** ç¼–è¯‘çš„æ¨¡å— - éœ€è¦é’ˆå¯¹æ¯ä¸ªå¹³å°é‡æ–°ç¼–è¯‘
- **äºŒè¿›åˆ¶ä¾èµ–** - å¦‚ `fsevents`ï¼ˆmacOS ä¸“ç”¨ï¼‰ã€`@electron/get`ï¼ˆå¹³å°ç‰¹å®šï¼‰

### 2. æ–‡ä»¶ç³»ç»Ÿå·®å¼‚

- **è·¯å¾„åˆ†éš”ç¬¦**ï¼šWindows ä½¿ç”¨ `\`ï¼ŒmacOS/Linux ä½¿ç”¨ `/`
- **å¤§å°å†™æ•æ„Ÿæ€§**ï¼šmacOS é»˜è®¤ä¸åŒºåˆ†å¤§å°å†™ï¼ŒLinux åŒºåˆ†
- **ç¬¦å·é“¾æ¥**ï¼šä¸¤ä¸ªå¹³å°å¤„ç†æ–¹å¼ä¸åŒ

### 3. Yarn PnP é—®é¢˜

æœ¬é¡¹ç›®ä½¿ç”¨ Yarn PnPï¼ˆPlug'n'Playï¼‰ï¼Œæ›´ä¸é€‚åˆè·¨å¹³å°å…±äº«ï¼š
- PnP ä½¿ç”¨ `.pnp.cjs` å’Œç¼“å­˜ï¼Œè¿™äº›æ˜¯å¹³å°ç‰¹å®šçš„
- è·¯å¾„è§£ææœºåˆ¶åœ¨ä¸åŒå¹³å°å¯èƒ½ä¸åŒ

### 4. æ„å»ºå·¥å…·é—®é¢˜

- **esbuild** - è™½ç„¶æ˜¯è·¨å¹³å°çš„ï¼Œä½†æŸäº›ä¾èµ–å¯èƒ½éœ€è¦é‡æ–°ç¼–è¯‘
- **electron-builder** - éœ€è¦å¹³å°ç‰¹å®šçš„å·¥å…·é“¾

## âœ… æœ€ä½³å®è·µ

### æ¨èæ–¹æ¡ˆï¼šæ¯ä¸ªå¹³å°ç‹¬ç«‹å®‰è£…ä¾èµ–

åœ¨æ¯ä¸ªå¹³å°ä¸Šå•ç‹¬è¿è¡Œï¼š

```bash
# macOS ä¸Š
yarn install

# Windows ä¸Šï¼ˆç›¸åŒçš„å‘½ä»¤ï¼‰
yarn install
```

Yarn ä¼šæ ¹æ®å½“å‰å¹³å°è‡ªåŠ¨å®‰è£…æ­£ç¡®çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

### å…±äº«çš„æ–‡ä»¶ï¼ˆå¯ä»¥åŒæ­¥ï¼‰

è¿™äº›æ–‡ä»¶**å¯ä»¥**è·¨å¹³å°å…±äº«ï¼š

- âœ… `package.json` - ä¾èµ–å£°æ˜
- âœ… `yarn.lock` - é”å®šç‰ˆæœ¬ï¼ˆç¡®ä¿ç‰ˆæœ¬ä¸€è‡´ï¼‰
- âœ… `src/` - æºä»£ç 
- âœ… `public/` - é™æ€èµ„æº
- âœ… `electron/` - Electron æºä»£ç 
- âœ… `scripts/` - æ„å»ºè„šæœ¬

### ä¸å…±äº«çš„æ–‡ä»¶ï¼ˆå¹³å°ç‰¹å®šï¼‰

è¿™äº›æ–‡ä»¶**ä¸åº”è¯¥**è·¨å¹³å°å…±äº«ï¼š

- âŒ `node_modules/` - ä¾èµ–åŒ…ï¼ˆå¹³å°ç‰¹å®šï¼‰
- âŒ `.pnp.cjs` - Yarn PnP æ–‡ä»¶ï¼ˆå¹³å°ç‰¹å®šï¼‰
- âŒ `.yarn/cache/` - Yarn ç¼“å­˜ï¼ˆå¯èƒ½åŒ…å«å¹³å°ç‰¹å®šæ–‡ä»¶ï¼‰
- âŒ `dist/` - æ„å»ºè¾“å‡ºï¼ˆå¹³å°ç‰¹å®šï¼‰
- âŒ `dist-electron/` - Electron æ„å»ºè¾“å‡ºï¼ˆå¹³å°ç‰¹å®šï¼‰
- âŒ `release/` - æ‰“åŒ…è¾“å‡ºï¼ˆå¹³å°ç‰¹å®šï¼‰

## ğŸ“‹ .gitignore é…ç½®

ç¡®ä¿ `.gitignore` åŒ…å«å¹³å°ç‰¹å®šçš„æ–‡ä»¶ï¼š

```gitignore
# ä¾èµ–
node_modules/
.pnp.*
.yarn/*
!.yarn/patches
!.yarn/plugins
!.yarn/releases
!.yarn/sdks
!.yarn/versions

# æ„å»ºè¾“å‡º
dist/
dist-electron/
release/

# å¹³å°ç‰¹å®š
.DS_Store          # macOS
Thumbs.db          # Windows
```

## ğŸ”„ å¤šå¹³å°å¼€å‘å·¥ä½œæµ

### åœºæ™¯ 1ï¼šåœ¨ macOS å¼€å‘ï¼ŒWindows æ‰“åŒ…

```bash
# macOS å¼€å‘
yarn install       # å®‰è£… macOS ç‰ˆæœ¬çš„ä¾èµ–
yarn dev          # å¼€å‘æµ‹è¯•
yarn build        # æ„å»ºï¼ˆç”¨äºæµ‹è¯•ï¼‰

# Windows æ‰“åŒ…ï¼ˆåœ¨ Windows ç³»ç»Ÿä¸Šï¼‰
git pull          # åŒæ­¥ä»£ç 
yarn install      # å®‰è£… Windows ç‰ˆæœ¬çš„ä¾èµ–
yarn build        # æ„å»º Windows ç‰ˆæœ¬
yarn electron:build:win  # æ‰“åŒ… .exe
```

### åœºæ™¯ 2ï¼šå›¢é˜Ÿåä½œ

1. **ä»£ç å…±äº«**ï¼šä½¿ç”¨ Git å…±äº«æºä»£ç 
2. **ä¾èµ–ç®¡ç†**ï¼šæ¯ä¸ªæˆå‘˜åœ¨è‡ªå·±çš„å¹³å°ä¸Šè¿è¡Œ `yarn install`
3. **æ„å»º**ï¼šåœ¨å„è‡ªå¹³å°æ„å»ºï¼Œæˆ–ä½¿ç”¨ CI/CD

### åœºæ™¯ 3ï¼šä½¿ç”¨ CI/CDï¼ˆæ¨èï¼‰

ä½¿ç”¨ GitHub Actions æˆ–å…¶ä»– CI æœåŠ¡ï¼š

```yaml
# .github/workflows/build.yml
name: Build
on: [push]
jobs:
  build-windows:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: yarn install
      - run: yarn build
      - run: yarn electron:build:win
  
  build-macos:
    runs-on: macos-latest
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-node@v2
      - run: yarn install
      - run: yarn build
      - run: yarn electron:build
```

## âš™ï¸ é¡¹ç›®é…ç½®

### å½“å‰é¡¹ç›®çš„ä¾èµ–åˆ†æ

æŸ¥çœ‹ `package.json`ï¼Œä¸»è¦ä¾èµ–ï¼š

- âœ… **çº¯ JavaScript ä¾èµ–**ï¼ˆå¯è·¨å¹³å°ï¼‰ï¼š
  - React, React-DOM
  - GSAP
  - Three.js
  - Pixi.js
  - Vite

- âš ï¸ **å¹³å°ç‰¹å®šä¾èµ–**ï¼ˆéœ€è¦åˆ†åˆ«å®‰è£…ï¼‰ï¼š
  - Electron - éœ€è¦å¹³å°ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶
  - esbuild - è™½ç„¶æ˜¯è·¨å¹³å°çš„ï¼Œä½†æŸäº›å·¥å…·é“¾ä¾èµ–å¯èƒ½ä¸åŒ

### ä½¿ç”¨ Yarn Workspaceï¼ˆå¦‚æœæœ‰å¤šé¡¹ç›®ï¼‰

å¦‚æœå°†æ¥éœ€è¦ç®¡ç†å¤šä¸ªé¡¹ç›®ï¼š

```json
{
  "workspaces": [
    "packages/*"
  ]
}
```

æ¯ä¸ªå·¥ä½œåŒºä¼šåœ¨å„è‡ªç›®å½•ä¸‹å®‰è£… `node_modules`ã€‚

## ğŸ’¡ å®ç”¨å»ºè®®

### 1. ä½¿ç”¨ Git åŒæ­¥ä»£ç 

```bash
# åœ¨ macOS ä¸Šå¼€å‘
git add .
git commit -m "Update code"
git push

# åœ¨ Windows ä¸ŠåŒæ­¥
git pull
yarn install  # é‡æ–°å®‰è£…ä¾èµ–ï¼ˆWindows ç‰ˆæœ¬ï¼‰
```

### 2. ä½¿ç”¨ Dockerï¼ˆé«˜çº§ï¼‰

å¦‚æœéœ€è¦åœ¨ä¸åŒå¹³å°æµ‹è¯•ï¼Œå¯ä»¥ä½¿ç”¨ Dockerï¼š

```dockerfile
FROM node:20
WORKDIR /app
COPY package.json yarn.lock ./
RUN yarn install
COPY . .
RUN yarn build
```

### 3. å…±äº« Yarn ç¼“å­˜ï¼ˆå¯é€‰ï¼‰

å¯ä»¥å…±äº« `.yarn/cache/` ç›®å½•æ¥åŠ é€Ÿå®‰è£…ï¼Œä½†è¦æ³¨æ„ï¼š

- æŸäº›ç¼“å­˜æ–‡ä»¶æ˜¯å¹³å°ç‰¹å®šçš„
- å»ºè®®ä»…åœ¨ç›¸åŒæ¶æ„é—´å…±äº«ï¼ˆå¦‚éƒ½æ˜¯ x64ï¼‰

## ğŸ“ æ€»ç»“

| é¡¹ç›® | macOS | Windows | æ˜¯å¦å¯å…±äº« |
|------|-------|---------|-----------|
| `package.json` | âœ… | âœ… | âœ… æ˜¯ |
| `yarn.lock` | âœ… | âœ… | âœ… æ˜¯ |
| `src/` æºä»£ç  | âœ… | âœ… | âœ… æ˜¯ |
| `node_modules/` | âœ… | âœ… | âŒ **å¦** |
| `.pnp.cjs` | âœ… | âœ… | âŒ **å¦** |
| `dist/` æ„å»ºè¾“å‡º | âœ… | âœ… | âŒ **å¦** |

## âœ… æ¨èåšæ³•

1. **æ¯ä¸ªå¹³å°å•ç‹¬å®‰è£…ä¾èµ–**ï¼š
   ```bash
   yarn install
   ```

2. **é€šè¿‡ Git åŒæ­¥ä»£ç **ï¼ˆä¸æäº¤ node_modulesï¼‰

3. **æ„å»ºæ—¶åœ¨ç›®æ ‡å¹³å°æ„å»º**ï¼š
   - macOS åº”ç”¨åœ¨ macOS ä¸Šæ„å»º
   - Windows åº”ç”¨åœ¨ Windows ä¸Šæ„å»º

4. **ä½¿ç”¨ CI/CD è‡ªåŠ¨åŒ–æ„å»º**ï¼ˆå¦‚æœå¯èƒ½ï¼‰

è¿™æ ·å¯ä»¥ç¡®ä¿æ¯ä¸ªå¹³å°çš„ä¾èµ–éƒ½æ˜¯æ­£ç¡®å’Œå®Œæ•´çš„ï¼

